# Churn Mitigation Project

The repository contains all the material related to the case study for the churn mitigation project.

A number of crucial scripts guide the analysis:

* `0_churn_exploration.R` data exploration and preparation.
* `1_churn_modeling.R` model training and evaluation
* `2_churn_save_model.R` saves the final model and the information needed to explain the predictions (SHAP values through DALEXExtra explainer object).
* `3_deploy_model.R` deploys the model to be served on an API endpoint.
* `generate_app_data.R` generates synthetic client data to be used in the Shiny application for demonstration purposes.
* `report_churn_prediction.Rmd` report that presents the results of the predictive modeling analysis.

A number of sub-folders are available in the repository, as described below.

## Data

The data used in the case study is available in the `data` folder. It contains:

* `churn_data.csv` A sample of churn data for a private bank in Geneva (provided by the recruiter). 
* `iran_customer_churn.csv` A sample of data for an Iranian Telecommunications company which allowed to show the typical performance of the models in a more realistic setting.
* `churn_data_synth.csv` A synthetic dataset generated by the authors to test the models and provide more realistic results (see `generate_app_data.R`).

## Prediction models

The `model_versions` folder contains the different versions of the models generated by the training process. The folder contains pins objects that can be used to load the models and information needed to explain the predictions (SHAP values through DALEXExtra explainer object).

The models are saved through the `2_churn_save_model.R` script in the top level directory.

## Application

The `app` folder contains the Shiny application that allows to interact with the models and leverage an AI assistant to help with the churn inspection.

## Prompt templates

To guide the AI assistant, a number of prompt templates are available in the `prompts` folder and used to generate an enriched user prompt with the client data and the SHAP values.